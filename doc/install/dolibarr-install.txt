  Dolibarr Installation
  Rodolphe Quiédeville
  $Id: dolibarr-install.sgml,v 1.10 2003/10/28 12:45:55
  rodolphe Exp $

  Installation et mise à jour de Dolibarr
  ______________________________________________________________________

  Table des matières


  1. Installation
     1.1 Récupérer les sources
     1.2 Pré-requis
        1.2.1 Pear
     1.3 Base de données
     1.4 Apache
     1.5 Dolibarr

  2. Mise à jour
     2.1 Mise à jour de la base de données
     2.2 Autres actions

  3. Annexe A - Fichiers de conf Apache
     3.1 Fichier de config pour Apache 1.3
     3.2 Fichier de config pour Apache 1.3 + mod_auth_mysql
     3.3 Fichier de config pour Apache 2 + mod_auth_mysql + webmin


  ______________________________________________________________________

  [1m1.  Installation[0m

  [1m1.1.  Récupérer les sources[0m

  Récupérer les sources sur  <http://www.dolibarr.com/>

  Les sources se présentent sous la forme d'un fichier tar compressé
  avec gzip.

  [1m1.2.  Pré-requis[0m

  Liste des logiciels à installer pour faire fonctionner Dolibarr :


  ·  php4

  ·  php4-mysql

  ·  php4-curl (pour la partie gestion des adhérents)

  ·  php4-gd (pour les graphiques)

  ·  Apache

     Pour la gestion de l'authentification, Dolibarr fonctionne soit
     avec mod-auth-mysql soit avec Pear. Cette dernière est plus facile
     à installer.

  ·  Pear (package Auth)

  ·  libapache-mod-auth-mysql



  [1m1.2.1.  Pear[0m

  Pear est un ensemble de classes et d'outils pour les installer et les
  mettre à jour. Les classes requises pour Dolibarr sont (par ordre
  d'installation) :


  ·  Archive_Tar

  ·  Console_Getopt

  ·  PEAR

  ·  Auth

  ·  DB

  Pour installer un paquet Pear, exécutez en root '$ pear install <nom
  du paquet>'.

  Pour plus d'informations sur Pear et sa configuration, veuillez vous
  reporter à son site officiel  <pear.php.net>.

  [1m1.3.  Base de données[0m

  1- créer une base de données mysql appelée 'dolibarr' (vous pouvez
  changer le nom, dans ce cas remplacer dans la suite des commandes
  'dolibarr' par le nom de votre base de données)



               # mysqladmin create dolibarr



  2- charger la base en exécutant :



               # mysql dolibarr < mysql/mysql.sql



  [1m1.4.  Apache[0m

  Pour configurer Apache : des fichier httpd.conf.dist est fournit avec
  les sources, vous pouvez vous en servir pour configurer votre serveur,
  il est prévu pour que vous ayez juste à ajouter une régle Include dans
  votre fichier principal httpd.conf.

  Utilisez le fichier httpd.conf.dist pour l'authentification par Pear
  (conseillé) et le fichier httpd.conf.dist.modauth pour utiliser mod-
  auth-mysql.

  [1m1.5.  Dolibarr[0m

  Créer un répertoire appelé document dans le répertoire htdocs des
  sources et affectez les droits d'écriture dans ce répertoire à
  l'utilisateur exécutant le serveur web.


  Créer un fichier conf/conf.php et donnez les droits d'écriture dans ce
  fichier à l'utilisateur exécutant le serveur web.

  Pour configurer Dolibarr accédez à la page


       /install.php



  , pour vous logger utlisez le login [1madmin [22mavec le mot de passe [1madmin[22m.

  Si les contrôles sont corrects vous n'avez qu'à cliquer sur le lien,
  'Configurer les modules'.

  Une fois les modules configurés il ne reste plus qu'à définir les
  utilisateurs et leurs permissions respectives. Pour cela cliquer sur
  Accueil -> Utilisateurs

  Il est fortement conseillé de supprimer le fichier install.php une
  fois l'installation terminée. De même pensez à modifier le mot de
  passe de l'utilisateur admin.

  [1m2.  Mise à jour[0m

  Certaines action sont nécessaires lors de la mise à jour de Dolibarr
  vers une version plus récente des sources.

  [1m2.1.  Mise à jour de la base de données[0m

  Il peut être nécessaire de faire des modifications sur la structure
  et/ou les données contenues dans la base Mysql lors de la mise à jour
  de Dolibarr. Pour cela des scripts sont fournis dans le répertoire
  mysql/migration/. Il se présente sous la forme a.b.c-e.d.f.sql, les
  trois premiers numéros indique la version de départ et les 3 suivants
  la version que vous souhaitez atteindre. Si vous passez par exemple de
  la version 0.1.3 à la version 0.1.6 il vous faudra appliquer les
  patchs 0.1.3-0.1.4.sql, 0.1.4-0.1.5.sql et 0.1.5-0.1.6.sql si un patch
  n'éxiste pas d'une version à une autre c'est qu'il n'y a pas eu de
  modification de base.

  [1m2.2.  Autres actions[0m

  Il peut-être nécessaire d'effectuer d'autres actions lors de la mise à
  jour, comme la désactivation et la réactivation des modules. Cette
  information est communiquée dans le fichier README à la racine des
  sources.

  [1m3.  Annexe A - Fichiers de conf Apache[0m

  [1m3.1.  Fichier de config pour Apache 1.3[0m

  Exemple pour l'authentification avec Pear



  ______________________________________________________________________
          #
          # Sample httpd.conf for dolibarr
          #
          <VirtualHost dolibarr.lafrere.lan>
          ServerAdmin webmaster.fr@lolix.org
          DocumentRoot /home/www/dolibarr/dolibarr/htdocs
          ServerName dolibarr.lafrere.lan
          ErrorLog  /home/www/dolibarr/logs/error.log
          CustomLog /home/www/dolibarr/logs/access.log combined

          ErrorDocument 401 /public/error-401.html

          php_flag register_globals on

          </VirtualHost>

  ______________________________________________________________________



  [1m3.2.  Fichier de config pour Apache 1.3 + mod_auth_mysql[0m

  Cet exemple ne fonctionne pas sur la série Apache 2, voir le fichier
  correspond dans la section suivante.



  ______________________________________________________________________
          #
          # Sample httpd.conf for dolibarr
          #
          <VirtualHost dolibarr.lafrere.lan>
          ServerAdmin webmaster.fr@lolix.org
          DocumentRoot /home/www/dolibarr/dolibarr/htdocs
          ServerName dolibarr.lafrere.lan
          ErrorLog  /home/www/dolibarr/logs/error.log
          CustomLog /home/www/dolibarr/logs/access.log combined

          ErrorDocument 401 /public/error-401.html

          php_flag register_globals on

          <Location />
          Options Indexes FollowSymLinks
          AllowOverride All
          Order deny,allow
          Deny from all

          AuthType                                Basic

          # N'utilisez la ligne suivante que si vous utilisez aussi
          # le module d'authentification basé sur postgresql
          #Auth_MySQL_Authoritative               on

          # Utilisez les lignes suivantes si le serveur Apache ne
          # peut se logger en anonymous (ce qui est conseillé ;-)
          # rq. erics: sur ma debian je n'ai pas le droit de mettre ces
          # instructions dans un <virtualhost> ... (apache 1.3.27.0-2)
          #AuthMySQL_DefaultHost <host>
          #AuthMySQL_DefaultUser <user>
          #AuthMySQL_DefaultPassword <pass>

          Auth_MySQL_DB                   dolibarr
          Auth_MySQL_Password_Table               llx_user
          Auth_MySQL_Username_Field               login
          Auth_MySQL_Password_Field               pass

          # Pour l'instant les pass sont enregistrés en clair
          # le stockage crypté est dans la TODO

          Auth_MySQL_Encrypted_Passwords  off

          AuthName                                "Dolibarr"

          require valid-user
          satisfy any
          </Location>

          <Location /public/>
          Options Indexes FollowSymLinks
          AllowOverride All
          Order deny,allow
          Allow from all
          </Location>

          </VirtualHost>

  ______________________________________________________________________



  [1m3.3.  Fichier de config pour Apache 2 + mod_auth_mysql + webmin[0m



  ______________________________________________________________________
        Options Indexes FollowSymLinks
        AllowOverride All
        Order deny,allow
        Deny from all

        AuthType Basic

        # N'utilisez la ligne suivante que si vous utilisez aussi
        # le module d'authentification basé sur postgresql
        AuthMySQLAuthoritative on

        # Utilisez les lignes suivantes si le serveur Apache ne
        # peut se logger en anonymous (ce qui est conseillé ;-)
        # rq. erics: sur ma debian je n'ai pas le droit de mettre ces
        # instructions dans un <virtualhost> ... (apache 1.3.27.0-2)
        #AuthMySQL_DefaultHost <host>
        #AuthMySQL_DefaultUser <user>
        #AuthMySQL_DefaultPassword <pass>

        AuthMySQLHost localhost
        AuthMySQLUser leDBuser
        AuthMySQLPassword leDBpass
        AuthMySQLDB dolibarr
        AuthMySQLUserTable llx_user
        AuthMySQLNameField login
        AuthMySQLPasswordField pass

        # Pour l'instant les pass sont enregistrés en clair
        # le stockage crypté est dans la TODO
        AuthMySQLCryptedPasswords off

        AuthName "Dolibarr"

        require valid-user
        Satisfy any

  ______________________________________________________________________



  Pour les gens qui installent Dolibarr dans un répertoire, utilisez
  Webmin et ajoutez une "Per-Directory Options" à votre serveur virtuel.
  Utilisez "Location" comme "Type" et "/dolibarr" comme "Path". Une fois
  créée, editez les directives et copiez la config ci-dessus, sauvez,
  restartez Apache et testez en allant à domainname.com/dolibarr. Le
  navigateur va vous demander de taper le login/pass.

  Il faut créer des options pour chaque <Location> du fichier httpd.conf
  donné en exemple.

  Merci à la personne qui m'a transmis ces infos, et aux précédentes qui
  avaient fait de même au sujet d'Apache 2



